<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ—ãƒ¬ã‚¼ãƒ³ç™»å£‡è€…ç”³ã—è¾¼ã¿</title>
    <link rel="stylesheet" href="shared/common.css">
    <link rel="stylesheet" href="pages/apply.css">
</head>
<body>
    <header>
        <h1>ãƒ—ãƒ¬ã‚¼ãƒ³ç™»å£‡è€…ç”³ã—è¾¼ã¿</h1>
        <nav>
            <a href="admin/lottery.html" class="nav-link admin-link">ğŸ” æŠ½é¸ç®¡ç†</a>
        </nav>
    </header>

    <main>
        <div class="container">
            <h2>ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç”³ã—è¾¼ã¿</h2>
            <p>ã‚ãªãŸã®åå‰ã‚’å…¥åŠ›ã—ã¦ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®æŠ½é¸ã«å‚åŠ ã—ã¦ãã ã•ã„ã€‚</p>
            
            <form id="apply-form">
                <div class="form-group">
                    <label for="participant-name">ãŠåå‰</label>
                    <input 
                        type="text" 
                        id="participant-name" 
                        name="name" 
                        placeholder="ä¾‹: ç”°ä¸­å¤ªéƒ"
                        maxlength="50"
                        required
                    >
                    <small class="form-help">â€»50æ–‡å­—ä»¥å†…ã§å…¥åŠ›ã—ã¦ãã ã•ã„</small>
                </div>
                
                <button type="submit" class="btn" id="submit-btn">
                    ç”³ã—è¾¼ã‚€
                </button>
            </form>
        </div>

        <div class="container">
            <h3>ç¾åœ¨ã®å‚åŠ è€…</h3>
            <div id="participants-count" class="participants-count">
                èª­ã¿è¾¼ã¿ä¸­...
            </div>
            <div id="participants-list" class="participants-list">
                <!-- å‚åŠ è€…ãƒªã‚¹ãƒˆãŒå‹•çš„ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
            </div>
        </div>

        <div class="container info-section">
            <h3>ğŸ“ ç”³ã—è¾¼ã¿ã«ã¤ã„ã¦</h3>
            <ul>
                <li>ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®é †ç•ªã¯å¾Œæ—¥æŠ½é¸ã§æ±ºå®šã•ã‚Œã¾ã™</li>
                <li>åŒã˜åå‰ã§ã®é‡è¤‡ç”³ã—è¾¼ã¿ã¯ã§ãã¾ã›ã‚“</li>
                <li>ç”³ã—è¾¼ã¿å¾Œã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã¯ç®¡ç†è€…ã«ãŠç”³ã—å‡ºãã ã•ã„</li>
            </ul>
            
            <div class="admin-access">
                <h4>ğŸ” ç®¡ç†è€…ã®æ–¹ã¸</h4>
                <p>æŠ½é¸ã®å®Ÿè¡Œã¯ <a href="admin/lottery.html" class="admin-link">æŠ½é¸ç®¡ç†ç”»é¢</a> ã§è¡Œã£ã¦ãã ã•ã„ã€‚</p>
            </div>
        </div>
    </main>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script>
      // Firebase è¨­å®š
      const firebaseConfig = {
        apiKey: "AIzaSyBpPgGty0kDVCbJdJYIPU75YkTmKsqkSbc",
        authDomain: "lt-tyusen.firebaseapp.com",
        projectId: "lt-tyusen",
        storageBucket: "lt-tyusen.firebasestorage.app",
        messagingSenderId: "493442648894",
        appId: "1:493442648894:web:e022f3b47fc5c1f4cbba6f",
        measurementId: "G-DXZ1VP7ESC"
      };
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();
    </script>

    <script src="shared/utils.js"></script>
    <script src="shared/api.js"></script>
    <script src="pages/apply.js"></script>
    <script>

        // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        window.addEventListener('error', (e) => {
            console.error('Global error:', e.error);
        });

        window.addEventListener('unhandledrejection', (e) => {
            console.error('Unhandled promise rejection:', e.reason);
        });

        // ç”³ã—è¾¼ã¿ãƒšãƒ¼ã‚¸åˆæœŸåŒ–
        try {
            new ApplyPage();
        } catch (error) {
            console.error('ApplyPage initialization error:', error);
            document.querySelector('main').innerHTML = `
                <div class="container">
                    <div class="error">
                        <h3>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ</h3>
                        <p>ã‚¨ãƒ©ãƒ¼: ${error.message}</p>
                        <button onclick="location.reload()">ãƒªãƒ­ãƒ¼ãƒ‰</button>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>